-- Comentarios
-- A Linha abaixo cria um Banco de Dados
create database dbmeusservicos;
-- A Linha abaixoescolhe o Banco de Dados
use dbmeusservicos;
-- Obloco de instruções abaixo cria uma Tabela
create table tbusuarios(
iduser MEDIUMINT NOT NULL AUTO_INCREMENT Primary key,
usuario varchar(50) not null,
cargo_usuario varchar(50),
telefone varchar(20) not null,
login varchar(50) not null unique,
senha varchar(50) not null,
perfil varchar(50) not  null,
comissao varchar(50)not null,
salario varchar(30)
);

insert into tbusuarios(iduser,usuario,cargo_usuario,telefone,login,senha,perfil,comissao)
values(1,'Administrador','Administrador','000000000000000','admin','admin123','Administrador','0%');

create table tbclientes(
idcli MEDIUMINT NOT NULL AUTO_INCREMENT Primary key,
nomecli varchar(60) not null,
sexocli varcharacter(1),
cepcli varchar(15),
endcli varchar(150),
telefonecli varchar(20),
emailcli varchar(50),
quantidade_comprada int,
valor_gasto varchar(50),
ticket_medio varchar(50),
atividade varchar(50),
ultima_compra date,
prazo_inativo date,
crediario varchar(50)
);
select * from tbclientes;
insert into tbclientes(nomecli,quantidade_comprada,valor_gasto,ticket_medio,crediario)values('Vendas Sem Registro.','0.00','0.00','0.00','Habilitado');
select * from tbclientes where quantidade_comprada > 0;

create table tbsubclientes(
idsub MEDIUMINT NOT NULL AUTO_INCREMENT Primary key,
nome varchar(60) not null,
endereco text,
genero varchar(20),
telefone varchar(30),
cep varchar(20),
email varchar(80),
especie_marca varchar(100),
raca_modelo varchar(80),
tamanho varchar(80),
cor varchar(80),
descricao varchar(80),
ano varchar(4),
referencia varchar(100),
obs text,
tipo varchar(80)
);
select * from tbsubclientes;
select idsub as ID, nome as Nome, tipo as Tipo from tbsubclientes where referencia=3;

create table tbos(
os MEDIUMINT NOT NULL AUTO_INCREMENT Primary key,
data_os timestamp default current_timestamp,
tipo varchar(50) not null,
situacao varchar(50) not null,
previsao_entreg_os date,
equipamento varchar(150) not null,
defeito varchar(150) not null,
servico varchar(150),
funcionario varchar(30),
valor varchar(20),
cliente varchar(50)
);

select os as Numero_da_Ordem_de_Serviço, data_os as Emição, tipo as Tipo, situacao as Situação, previsao_entreg_os as Previsão_de_Entrega, equipamento as Equipamento, 
defeito as Defeito, servico as Serviço, tecnico as Tecnico, valor as Valor, cliente as Cliente from tbos where os =1;

create table tbvenda(
idvenda MEDIUMINT NOT NULL AUTO_INCREMENT Primary key,
nome varchar(50),
preco varchar(20),
quantidade int,
identificador varchar(30),
comissao varchar(80),
vendedor varchar(80),
categoria varchar(80),
tipo varchar(80)
);

select * from tbvenda;

create table tbtotalvendas(
id  MEDIUMINT NOT NULL AUTO_INCREMENT Primary key,
dia date,
hora varchar(50),
venda varchar(20),
forma_pagamento varchar(50),
status_pagamento varchar(50),
dia_Pagamento date,
idcliente varchar(10),
cliente varchar(50),
tipo varchar(50)
);

select *  from tbtotalvendas;
select id from tbtotalvendas where id ORDER BY id desc;

select id as ID ,dia as Data_Emicao, hora as Hora, cliente as Cliente_Suprimento, venda as Valor , dia_Pagamento as Dia_Pagamento from tbtotalvendas 
where status_pagamento='Pago' and  dia = current_date();

select *  from tbtotalvendas;
describe tbtotalvendas;

create table tbprodutos(
idproduto MEDIUMINT NOT NULL AUTO_INCREMENT Primary key,
codigo varchar(18),
produto varchar(50),
valor_compra varchar(12),
valor_venda varchar(12),
fornecedor varchar(50),
obs text,
estoque varchar(30),
quantidade int,
referencial_compra varchar(22),
referencial_venda varchar(22),
compra_x_venda varchar(22)
);

select * from tbprodutos;

create table tbcompra(
idcompra MEDIUMINT NOT NULL AUTO_INCREMENT Primary key,
nome_produto varchar(50),
valor varchar(20),
valor_unidade varchar(20),
quantidade_comprada int,
fornecedor varchar(50),
identificador varchar(30)
);


create table tbgastos(
idgastos MEDIUMINT NOT NULL AUTO_INCREMENT Primary key,
valor varchar(20),
data_emissao date,
data_pagamento date,
nome varchar(50),
forma_pagamento varchar(50),
status_pagamento varchar(50),
tipo varchar(50)
);

select * from tbgastos;
select idgastos as ID, nome as Identificador, data_pagamento as Dia_Pagamento, valor as Valor  from tbgastos 
where status_pagamento='Pago' and data_pagamento = current_date();



create table tbfornecedor(
idfornecedor MEDIUMINT NOT NULL AUTO_INCREMENT Primary key,
nome_fornecedor varchar(80),
razaosocial varchar(80),
pessoa_juridica_fisica varchar(80),
cnpj varchar(80),
telefone_fornecedor varchar(20),
email_fornecedor varchar(80),
endereco text
);

create table tbrelatorio(
idRelatorio MEDIUMINT NOT NULL AUTO_INCREMENT Primary key,
nome_empresa varchar(200),
nome_proprietario varchar(200),
email_proprietario varchar(200),
descricao varchar(200),
numero varchar(200),
obs varchar(200),
cliente varchar(50),
imagem varchar(900),
preco varchar(50),
entrada varchar(50),
saida varchar(50),
lucro varchar(50)
);

create table tbservicos(
idservico MEDIUMINT NOT NULL AUTO_INCREMENT Primary key,
servico varchar(50),
id_cliente int,
id_C_referencia int,
data_agendada timestamp unique,
valor varchar(30),
obs text,
tipo varchar(80),
funcionario varchar(50)
);

select * from tbservicos where date(data_agendada) = current_date();
select idservico as ID,servico as Serviço, data_agendada as Data_Agendada, obs as OBS, tipo as Tipo from tbservicos where tipo='Agendada' or tipo='Pendente' and  idservico ORDER BY tipo ASC;
select * from tbservicos;

create table tbFuncionarios(
idFuncionario MEDIUMINT NOT NULL AUTO_INCREMENT Primary key,
funcionario varchar(80) unique,
salario varchar(50),
comissao varchar(10),
contrato date,
especialidade varchar(50),
tipo varchar(50),
data_pagamento date
);
select * from tbfuncionarios; 
update tbfuncionarios set data_pagamento="2020-06-07" where idfuncionario=1;



insert into tbrelatorio(idRelatorio) values(1);
select * from tbrelatorio;
  
  SELECT
    P.valor, 
    P.nome,
    C.cliente,
    C.venda   
FROM tbgastos P
   right join tbtotalvendas C
  ON P.status_pagamento='Pago' = C.status_pagamento='Pago';
 
 












